<div class="card">
    
    <!--barra para pendientes de envio-->
	<div class="card-header">
		<div id="loader" style="display: none">
			<i class="fa-spinner fa-spin fa-2x"> </i> Getting values
		</div>
		<span >Registro de Ruta</span>
	</div>

    <!--agregando estilos card de bootstrap-->
    <!--Ruta-->
	<div class="card-block" style="padding:3">
        <!--cabecera-->
		<div class="card-title ">
            <!--caja de texto para buscar-->
			<input placeholder="Buscar..." type="text"  id="gb1" #filtroGlobal />
            <!--para la busqueda BOTON NUEVO REGISTRO RUTA MAESTRO -->
			<span class="text-xs-right" >
                <button type="button" pButton icon="fa-2x" (click)="nuevaRutaMaestro()" label="Nuevo"></button>
			</span>
		</div>

        <!--tabla maestro ruta-->
		<div class="card-text">
            <!--paginacion de la filas de la datatable-->
            <!-- value:para la funcion de mostrar grilla -->
            <!-- selection: averiguar -->
			<p-dataTable [value]="rutasPresentar" [rows]="10" [paginator]="true"  
                
                [pageLinks]="3" [rowsPerPageOptions]="[5,10,20]" [globalFilter]="filtroGlobal" 
                scrollable="true"  scrollWidth="100%" selectionMode="single"
                [(selection)]="selectedRutaPresentar" (onRowSelect)="onRowSelect($event)">

                    <!--<p-column *ngFor="let col of columnDefs" [field]="col.field" [header]="col.header"></p-column>-->
                    <!--botones para la 1era columa -->
                    <p-column styleClass="col-button" [style]="{'width':'6em'}">

                        <!--Boton actualizar
                        <template pTemplate="header">
                            <button type="button" pButton icon="fa-refresh"></button>
                        </template>-->
                        
                        <!--Botones de cada fila-->
                        <template let-col let-Ruta="rowData" pTemplate="body" >
                            <!--Boton editar-->
                            <button type="button" pButton (click)="editarRutaMaestro(Ruta.RuId)" icon="fa-pencil-square-o" class="btn"></button>
                            <!--Boton eliminar-->
                            <button type="button" pButton (click)="eliminarRutaMaestro(Ruta.RuId)" icon="fa-trash" class="btn"></button>					
                        </template>          

                    </p-column>
                    <!--Nombre de las columnas de datatable-->
                    <p-column field="nro" header="N°" [style]="{'width':'3em'}"></p-column>
                    <!--<p-column field="RuId" header="Id" [sortable]="true" [style]="{'width':'4em'}"></p-column>-->
                    <p-column field="RuDescripcion" header="Descripcion" [style]="{'width':'10em'}" ></p-column>
                    <!--<p-column field="RuKilometro" header="Kilometro" [sortable]="true" [style]="{'width':'4em'}" ></p-column>-->
                    <p-column field="RuFechaCreacion" header="Fecha" [style]="{'width':'6em'}" ></p-column>
                     
                     <!--                   
                    <p-column field="EmTipo" header="Tipo" [sortable]="true" [style]="{'width':'5em'}"  ></p-column>
                     -->
                     
			</p-dataTable>
		</div><!--fin tabla ruta-->

         <!--Modal boton nuevo ruta-Maestro-->
         <p-dialog [(visible)]="displayNuevaRutaModal" modal="modal" width="100%" responsive="true" [closable]=false>
            <p-header>
                {{headertitle}} Ruta
            </p-header>
                    <div class="form-group row">
                        
                        <label for="descripcion" class="col-4 col-form-label">Descripcion: </label>
                        <div class="col-8">
                            <textarea class="form-control" id="descripcion" row="4" [(ngModel)]="Ruta.RuDescripcion" name="descripcion"  required #desc="ngModel" ></textarea>
                            <span *ngIf="!desc.valid && desc.touched" class="alert alert-danger" style="display: inline-block; font-size: 80%;"  >  
                                <div [hidden]="!desc.errors.required"> obligatorio </div>
                            </span>
                        </div>
                        
                    </div>
                    <div class="form-group row">
                        <label for="fechacreacion" class="col-4 col-form-label">Fecha Creacion:</label>
                        <div class="col-8">
                            <input type="date" class="form-control" id="fechacreacion" min="1980-01-01" [(ngModel)]="Ruta.RuFechaCreacion" name="fcreacion" required #fcrea="ngModel" />
                            <span *ngIf="!fcrea.valid && fcrea.touched" class="alert alert-danger" style="display: inline-block; font-size: 80%;"  >  
                                <div [hidden]="!fcrea.errors.required"> obligatorio </div>
                            </span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="regmunicipal" class="col-4 col-form-label">Nro. Registro:</label>
                        <div class="col-8">
                            <input type="text" class="form-control" id="regmunicipal" [(ngModel)]="Ruta.RuRegMunicipal" name="regmunicipal" required #freg="ngModel" />
                            <span *ngIf="!freg.valid && freg.touched" class="alert alert-danger" style="display: inline-block; font-size: 80%;"  >  
                                <div [hidden]="!freg.errors.required"> obligatorio </div>
                            </span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="kilometro" class="col-4 col-form-label">Kilometro: </label>
                        <div class="col-8">
                            <input type="number" class="form-control" id="kilometro" [(ngModel)]="Ruta.RuKilometro" name="kilometro" required #fkil="ngModel" pattern="[0-9]{2}"/>
                            <span *ngIf="!fkil.valid && fkil.touched" class="alert alert-danger" style="display: inline-block; font-size: 80%;"  >  
                                <div [hidden]="!fkil.errors.required"> obligatorio </div>
                                <div [hidden]="!fkil.errors.pattern">Solo 2 Digitos</div>
                            </span>
                        </div>
                    </div>
                    
            <p-footer>
                <div class="ui-dialog-buttonpane ui-widget-content">
                    <button type="button" pButton icon="fa-spin"  (click)="saveRutaMaestro()"  label="Guardar"></button>
                    <button type="button" pButton icon="fa-close" (click)="cancelRutaMaestro()" label="Cancelar"></button>
                </div>
            </p-footer>
        </p-dialog>



          <!--mapa-->
            <div class="container">
                <div class="form">
                    <h5 id="mymaparuta">Trazar la ruta</h5>
                </div>
                
                <p-growl [value]="msgs"></p-growl>
                <p-gmap 
                    #gmap
                    [options]="options" 
                    [overlays]="overlays"
                    [style]="{'width':'100%','height':'400px'}" 
                    (onMapClick)="handleMapClick($event)"
                    (onOverlayClick)="handleOverClick($event)"
                    (onOverlayDragEnd)="handleDragEnd($event)">
                </p-gmap>   
                
            </div>
            <div class="container">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-2"><button type="button" pButton  style = " width:41px; height:50px; font-size: 20px;"  icon="fa-eraser" (click)="clear()"[disabled]="disButBorrar"></button> </div>
                    <div class="ui-grid-col-2"><button type="button" pButton  style = " width:41px; height:50px; font-size: 20px;"  icon="fa-edit"       (click)="showmodalEditar()"         [disabled]="disButEditar"></button></div>              
                    <div class="ui-grid-col-2"><button type="button" pButton  style = " width:41px; height:50px; font-size: 20px;"  icon="fa-circle-o"   (click)="ultimalinea()"             [disabled]="disButTerminarRuta" ></button></div>
                    <div class="ui-grid-col-2"><button type="button" pButton  style = " width:41px; height:50px; font-size: 20px;"  icon="fa-save"       (click)="guardarPuntosRutaDetalle()"[disabled]="disButSubirRuta"></button></div>
                    <div class="ui-grid-col-2"><button type="button" pButton  style = " width:41px; height:50px; font-size: 20px;"  icon="fa-mail-reply" (click)="deshacer()"                [disabled]="disButDeshacer"></button></div>
                    <div class="ui-grid-col-2"><button type="button" pButton  style = " width:41px; height:50px; font-size: 20px;"  icon="fa-file-o"     (click)="nuevaRutaDetalle()"        [disabled]="disButNuevaRuta"></button></div>
                        <!--
                        <button type="button" pButton label="Zoom +"        (click)="zoomIn(gmap.getMap())"     ></button>
                        <button type="button" pButton label="Zoom -"        (click)="zoomOut(gmap.getMap())"    ></button>
                        -->
                </div>
            </div>
         
         <!--end mapa-->

         <!--modal boton editar (PARA DECIDIR SI SE EDITA O NO)-->
         <p-dialog  [(visible)]="displayfromEditar" modal="modal" width="100%" responsive="true">
            <p>¿Desea editar la Ruta?</p>
            <p-footer>
                <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                    <button type="button" pButton icon="fa-close" (click)="displayfromEditar=false" label="No"></button>
                    <button type="button" pButton icon="fa-check" (click)="editar()" label="Si"></button>
                </div>
            </p-footer>
         </p-dialog>

         <!--CONDICIONAL ELIMINAR-->
         <p-dialog [(visible)]="displayConfirmar" modal="modal" width="100%" responsive="true">
             <p>{{Mensaje}}</p>
             <p-footer>
                <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                    <button type="button" pButton icon="fa-close" (click)="displayConfirmar=false" label="No"></button>
                    <button type="button" pButton icon="fa-check" (click)="eliminarRuta()" label="Si"></button>
                </div>
            </p-footer>
         </p-dialog>
	</div>

    <!--MODAL PARA MENSAJES PARA EL USUARIO-->
            <!--NO SE PUEDE AGREGAR NODOS  SOBRE EL MAPA-->
            <p-dialog [(visible)]="displayAddMakerDesactivado" modal="modal" width="100%" responsive="true" [closable]="false">
                {{Mensaje}}
                <p-footer>
                    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                        <button type="button" pButton label="Aceptar" (click)="aceptarAddMarkerDesactivado()"></button>
                    </div>
                </p-footer>
            </p-dialog>

             <!--NO HAY GRAFICA DE LA RUTA-->
            <p-dialog [(visible)]="displaySinGrafica" modal="modal" width="100%" responsive="true" [closable]="false">
                {{Mensaje}}
                <p-footer>
                    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                        <button type="button" pButton label="Aceptar" (click)="aceptarSinGrafica()"></button>
                    </div>
                </p-footer>
            </p-dialog>

             <!--SE GUARDO LA RUTA CORRECTAMENTE-->
            <p-dialog [(visible)]="displayGuardarCorrecto" modal="modal" width="100%" responsive="true" [closable]="false">
                {{Mensaje}}
                <p-footer>
                    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                        <button type="button" pButton label="Aceptar" (click)="aceptarGuardarCorrectamente()"></button>
                    </div>
                </p-footer>
            </p-dialog>

            <!--NUEVA RUTA-->
            <p-dialog [(visible)]="displayNuevaRuta" modal="modal" width="100%" responsive="true" [closable]="false">
                {{Mensaje}}
                <p-footer>
                    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                        <button type="button" pButton label="Aceptar" (click)="aceptarNuevaRuta()"></button>
                    </div>
                </p-footer>
            </p-dialog>

            <!--DEBE TERMINAR LA RUTA PARA SELECCIONAR OTRA FILA-->
            <p-dialog [(visible)]="displayTerminarForSave" modal="modal" width="100%" responsive="true" [closable]="false">
                {{Mensaje}}
                <p-footer>
                    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                        <button type="button" pButton label="Aceptar" (click)="aceptarTerminarRuta()"></button>
                    </div>
                </p-footer>
            </p-dialog>

            <!--DEBE TERMINAR (TRAZAR) LA RUTA PARA GUARDAR-->
            <p-dialog [(visible)]="displayTermineRuta" modal="modal" width="100%" responsive="true" [closable]="false">
                {{Mensaje}}
                <p-footer>
                    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                        <button type="button" pButton label="Aceptar" (click)="aceptarTermineRuta()"></button>
                    </div>
                </p-footer>
            </p-dialog>
</div>